<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/luckytking.github.io\/",
  "author": {
    "@type": "Person",
    "name": "jefffff",
    
    "image": "https://luckytking.github.io/images/tk.jpg"
    
  },
  "name":"jefffff\u0027s Blog",
  "description":"",
  "url":"https:\/\/luckytking.github.io\/categories\/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.89.2 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="jefffff">
<meta name="keywords" content="">
<meta name="description" content="">


<meta property="og:description" content="">
<meta property="og:type" content="website">
<meta property="og:title" content="åç«¯å¼€å‘">
<meta name="twitter:title" content="åç«¯å¼€å‘">
<meta property="og:url" content="https://luckytking.github.io/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">
<meta property="twitter:url" content="https://luckytking.github.io/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">
<meta property="og:site_name" content="jefffff&#39;s Blog">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:locale" content="en">


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@none">


  <meta name="twitter:creator" content="@none">






  <meta property="og:image" content="https://luckytking.github.io/images/tk.jpg">
  <meta property="twitter:image" content="https://luckytking.github.io/images/tk.jpg">






    <title>åç«¯å¼€å‘</title>

    <link rel="icon" href="https://luckytking.github.io/favicon.jpg">
    
      <link rel="alternate" type="application/rss+xml" title="RSS" href="https://luckytking.github.io/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/index.xml">
    

    
      <link rel="publisher" href="https://plus.google.com/&#43;thibaudlepretre">
    

    <link rel="canonical" href="https://luckytking.github.io/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://luckytking.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://luckytking.github.io/" aria-label="">jefffff&#39;s Blog</a>
  </div>
  
    
      <a class="header-right-icon open-algolia-search"
         href="https://luckytking.github.io/#search" aria-label="">
    
    
      <i class="fa fa-lg fa-search"></i>
    
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://luckytking.github.io/#about" aria-label="">
          <img class="sidebar-profile-picture" src="https://luckytking.github.io/images/tk.jpg" alt="" />
        </a>
        <h4 class="sidebar-profile-name">jefffff</h4>
        
          <h5 class="sidebar-profile-bio">Stay hungry. Stay Foolish  <strong>COOL</strong></h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://luckytking.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://luckytking.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://luckytking.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://luckytking.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://luckytking.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/luckytking" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://luckytking.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
        

      
      <div id="main" data-behavior="2"
        class="
               hasCoverMetaIn
               ">
        
          <section class="postShorten-group main-content-wrap">
            
            
              
  
    
      
        
      
    
  


  

<article class="postShorten postShorten--thumbnailimg-right">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://luckytking.github.io/2023/02/dockergopostgresql%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E6%97%B6%E5%8C%BA/" aria-label="">
      
          Dockerã€Goã€PostgreSQLå¦‚ä½•ä¿®æ”¹æ—¶åŒº
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2023-02-25T15:55:06&#43;08:00">
        
   25, 2023

      </time>
    
    
  
  
    <span></span>
    
      <a class="category-link" href="https://luckytking.github.io/categories/%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91">åç«¯å¼€å‘</a>
    
  

  </div>

    </div>
    <div class="postShorten-excerpt">
      
        <p>æœ¬æ–‡ä¸»è¦ä»‹ç»Dockerã€Goã€PostgreSQLå¦‚ä½•ä¿®æ”¹å®ƒä»¬çš„æ—¶åŒºã€‚</p>
<p>é¦–å…ˆéœ€è¦çŸ¥é“ä¸€äº›åŸºç¡€æ¦‚å¿µ:</p>
<ol>
<li>Unix æ—¶é—´æˆ³ -æ˜¯ä»1970å¹´1æœˆ1æ—¥ï¼ˆUTC/GMTçš„åˆå¤œï¼‰å¼€å§‹æ‰€ç»è¿‡çš„ç§’æ•°ï¼Œä¸è€ƒè™‘é—°ç§’ã€‚</li>
<li>UTC &ndash;åè°ƒä¸–ç•Œæ—¶ï¼Œåˆç§°ä¸–ç•Œç»Ÿä¸€æ—¶é—´ã€ä¸–ç•Œæ ‡å‡†æ—¶é—´ã€å›½é™…åè°ƒæ—¶é—´ã€‚</li>
<li>CST&ndash;å¯è§†ä¸ºä¸­å›½ã€å¤å·´çš„æ ‡å‡†æ—¶é—´æˆ–ç¾å›½ã€æ¾³å¤§åˆ©äºšçš„ä¸­éƒ¨æ—¶é—´ã€‚åŒ—äº¬æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ä¸œå…«åŒºæ—¶é—´ã€‚</li>
</ol>
<h3 id="docker">Docker</h3>
<p>Docker ä½œä¸ºéƒ¨ç½²å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„ç¯å¢ƒï¼Œé»˜è®¤ä½¿ç”¨ UTC ä½œä¸ºå…¶å®¹å™¨çš„æ—¶åŒºï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æ¥ä¿®æ”¹æ—¶åŒºã€‚</p>
<p>ä¿®æ”¹çš„æ–¹æ³•</p>
<ol>
<li>åœ¨ Dockerfile ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ae81ff">ENV TZ=Asia/Shanghai</span>
</code></pre></div><ol start="2">
<li>åœ¨ Kubernetes ä¸­çš„ Pod é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  env å­—æ®µï¼Œè®¾ç½®ç¯å¢ƒå˜é‡ã€‚Example:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">my-container</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">my-image</span>
    <span style="color:#f92672">env</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">TZ</span>
        <span style="color:#f92672">value</span>: <span style="color:#ae81ff">Asia/Shanghai</span>
</code></pre></div><ol start="3">
<li>éªŒè¯åœ¨å®¹å™¨ä¸­ä½¿ç”¨ env å‘½ä»¤æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">env
</code></pre></div><p>è¾“å‡ºä¼šæœ‰keyä¸ºTZï¼Œvalueä¸ºAsia/Shanghaiè¡¨ç¤ºæˆåŠŸ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">TZ<span style="color:#f92672">=</span>Asia/Shanghai
</code></pre></div><h3 id="go">Go</h3>
<p>åœ¨ Go ä¸­ä¿®æ”¹æ—¶åŒºéœ€è¦ä½¿ç”¨æ ‡å‡†åº“ä¸­çš„ time åŒ…ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡FixedZoneæ¥ä¿®æ”¹æ—¶åŒºã€‚
Exampleï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">utcZone</span> = <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">FixedZone</span>(<span style="color:#e6db74">&#34;UTC&#34;</span>, <span style="color:#ae81ff">0</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3600</span>) <span style="color:#75715e">// UTC
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Local</span> = <span style="color:#a6e22e">utcZone</span>
	<span style="color:#a6e22e">utcNow</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
	<span style="color:#a6e22e">utcDate</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Date</span>(<span style="color:#a6e22e">utcNow</span>.<span style="color:#a6e22e">Year</span>(), <span style="color:#a6e22e">utcNow</span>.<span style="color:#a6e22e">Month</span>(), <span style="color:#a6e22e">utcNow</span>.<span style="color:#a6e22e">Day</span>(), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">utcNow</span>.<span style="color:#a6e22e">Location</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;UTC time: %s\n&#34;</span>, <span style="color:#a6e22e">utcDate</span>.<span style="color:#a6e22e">String</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;UTC timestamp: %d\n&#34;</span>, <span style="color:#a6e22e">utcDate</span>.<span style="color:#a6e22e">Unix</span>())

	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cstZone</span> = <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">FixedZone</span>(<span style="color:#e6db74">&#34;CST&#34;</span>, <span style="color:#ae81ff">8</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3600</span>) <span style="color:#75715e">// ä¸œå…«
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Local</span> = <span style="color:#a6e22e">cstZone</span>
	<span style="color:#a6e22e">cstNow</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
	<span style="color:#a6e22e">cstDate</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Date</span>(<span style="color:#a6e22e">cstNow</span>.<span style="color:#a6e22e">Year</span>(), <span style="color:#a6e22e">cstNow</span>.<span style="color:#a6e22e">Month</span>(), <span style="color:#a6e22e">cstNow</span>.<span style="color:#a6e22e">Day</span>(), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">cstNow</span>.<span style="color:#a6e22e">Location</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;CST time: %s\n&#34;</span>, <span style="color:#a6e22e">cstDate</span>.<span style="color:#a6e22e">String</span>())
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;CST timestamp: %d\n&#34;</span>, <span style="color:#a6e22e">cstDate</span>.<span style="color:#a6e22e">Unix</span>())
}
<span style="color:#75715e">//output
</span><span style="color:#75715e">//UTC time: 2023-02-25 00:00:00 +0000 UTC
</span><span style="color:#75715e">//UTC timestamp: 1677283200
</span><span style="color:#75715e">//CST time: 2023-02-25 00:00:00 +0800 CST
</span><span style="color:#75715e">//CST timestamp: 1677254400
</span></code></pre></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨time.FixedZoneåˆ†åˆ«è®¾ç½®UTCã€ä¸Šæµ·æ—¶åŒºï¼Œå¹¶è·å–å½“å¤©é›¶ç‚¹çš„æ—¶é—´æˆ³ _dateã€‚</p>
<h3 id="postgresql">PostgreSQL</h3>
<p><strong>åœ¨PostgreSQLç³»ç»Ÿå†…éƒ¨ï¼Œæ‰€æœ‰æ—¥æœŸå’Œæ—¶é—´éƒ½ç”¨å…¨çƒç»Ÿä¸€æ—¶é—´UTCæ ¼å¼å­˜å‚¨ï¼Œ æ—¶é—´åœ¨å‘ç»™å®¢æˆ·å‰ç«¯å‰ç”±æ•°æ®åº“æœåŠ¡å™¨æ ¹æ®TimeZone é…ç½®å‚æ•°å£°æ˜çš„æ—¶åŒºè½¬æ¢æˆæœ¬åœ°æ—¶é—´</strong>ã€‚</p>
<p>åœ¨ PostgreSQL ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ postgresql.conf æ–‡ä»¶æ¥ä¿®æ”¹æ—¶åŒºã€‚
ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ Dockerè¿è¡Œ PostgreSQL ä¸­ä¿®æ”¹æ—¶åŒºçš„æ­¥éª¤ï¼š</p>
<ol>
<li>æ‹·è´dockersä¸­çš„ postgresql.confåˆ°å®¿ä¸»ä¸»æœº</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo docker cp <span style="color:#f92672">[</span>your_docker_contariner_id<span style="color:#f92672">]</span>:/var/lib/postgresql/data/postgresql.conf /<span style="color:#f92672">[</span>your_work_space<span style="color:#f92672">]</span>/
</code></pre></div><ol start="2">
<li>ä¿®æ”¹é…ç½®</li>
</ol>
<pre tabindex="0"><code>sudo vi /[your_work_space]/postgresql.conf
</code></pre><p>æŸ¥æ‰¾æ›¿æ¢timezoneä¸ºä¸Šæµ·æ—¶åŒº</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">timezone = 'Asia/Shanghai'
</code></pre><p>å¯ä»¥é€šè¿‡sqlæŸ¥æ‰¾æ”¯æŒçš„æ—¶åŒºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> pg_timezone_names;
</code></pre></div><ol start="3">
<li>ä¿å­˜å¹¶è¦†ç›–dockersä¸­é…ç½®</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo docker cp /<span style="color:#f92672">[</span>your_work_space<span style="color:#f92672">]</span>/postgresql.conf <span style="color:#f92672">[</span>your_docker_contariner_id<span style="color:#f92672">]</span>:/var/lib/postgresql/data/
</code></pre></div><ol start="4">
<li>é‡æ–°å®¹å™¨</li>
</ol>
<pre tabindex="0"><code>sudo docker restart [your_docker_contariner_id
</code></pre><p>ç°åœ¨ï¼Œä½ çš„ PostgreSQL æ•°æ®åº“å°±ä½¿ç”¨äº†æ­£ç¡®çš„æ—¶åŒºã€‚</p>
<ol start="5">
<li>æ£€æŸ¥æ˜¯å¦è®¾ç½®æˆåŠŸ
é€šè¿‡sqlè·å–è®¾ç½®ï¼š</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> pg_db_role_setting;
</code></pre></div><p>ä¹Ÿå¯ä»¥æŸ¥çœ‹æ•°æ®åº“ä¸­è¡¨å­—æ®µæ ¼å¼ä¸ºTimestampTZï¼ŒExample
ä¿®æ”¹å‰</p>
<blockquote>
<p>2023-02-25 00:00:00 +0000 +00</p>
</blockquote>
<p>ä¿®æ”¹åå°</p>
<blockquote>
<p>2023-02-25 08:00:00 +0000 +08</p>
</blockquote>
<p>ä»¥ä¸Šã€‚</p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<ul>
<li><a href="https://yeasy.gitbook.io/docker_practice/image/dockerfile/env"> docker ä¿®æ”¹Env</a></li>
<li><a href="http://www.postgres.cn/docs/14/datatype-datetime.html">postgres.cn/docs</a></li>
<li><a href="https://hjxlog.com/posts/20210902215616.html"> åšå®¢dockers-postgre ä¿®æ”¹TimeZone</a></li>
</ul>
      
      <p>
        
          <a href="https://luckytking.github.io/2023/02/dockergopostgresql%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E6%97%B6%E5%8C%BA/" class="postShorten-excerpt_link link" aria-label=""></a>
        
        
      </p>
    </div>
  </div>
  
</article>

            
              
  
    
      
        
      
    
  


  

<article class="postShorten postShorten--thumbnailimg-right">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://luckytking.github.io/2022/11/go%E7%BD%91%E7%BB%9C%E6%8A%93%E5%8C%85%E5%BC%95%E6%B5%81%E5%B7%A5%E5%85%B7goreplay/" aria-label="">
      
          Goç½‘ç»œæŠ“åŒ…ã€å¼•æµå·¥å…·GoReplay
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-11-12T22:57:15&#43;08:00">
        
   12, 2022

      </time>
    
    
  
  
    <span></span>
    
      <a class="category-link" href="https://luckytking.github.io/categories/%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91">åç«¯å¼€å‘</a>
    
  

  </div>

    </div>
    <div class="postShorten-excerpt">
      
        <p>æœ¬æ–‡ç®€è¦ä»‹ç»Goç½‘ç»œæŠ“åŒ…ã€å¼•æµå·¥å…·GoReplayã€‚</p>
<h3 id="å‰è¨€">å‰è¨€</h3>
<p>åœ¨åç«¯çš„å®é™…å¼€å‘ä¸­ï¼Œä¼šé‡åˆ°ä»¥ä¸‹ä¸€äº›åœºæ™¯ï¼š</p>
<ul>
<li>ç”¨æˆ·é€šè¿‡ä½œå¼Šæ‰‹æ®µç»•è¿‡å‰ç«¯ï¼Œåˆ©ç”¨æŠ“åŒ…ï¼Œè¿›è¡Œç ´è§£ï¼Œæ¨¡æ‹Ÿï¼Œé­”æ”¹äº¤äº’æ•°æ®è¿›è¡Œä¼ªè£…ã€‚åç«¯ç¨‹åºéœ€è¦å¯¹å…¶æ“ä½œè®°å½•è¿›è¡Œé‡ç°å’Œè·Ÿè¸ªã€‚</li>
<li>æŸä¸ªbugåœ¨æµ‹è¯•ç¯å¢ƒæ— æ³•å¤ç°ã€‚</li>
<li>æœåŠ¡å‹æµ‹æ•°æ®å’Œçº¿ä¸Šæ•°æ®æœ‰åå·®ï¼Œå‹æµ‹æ•°æ®å¸Œæœ›èƒ½å’Œçº¿ä¸Šæ¥è¿‘ ã€‚</li>
</ul>
<p>GoReplayæ˜¯Goè¯­è¨€ç¼–å†™çš„æµé‡å›æ”¾å·¥å…·ï¼Œä¾¦å¬å™¨æœåŠ¡å™¨æ•è·httpæµé‡å¹¶å°†å…¶å‘é€åˆ°é‡æ”¾æœåŠ¡å™¨æˆ–ä¿å­˜åˆ°æ–‡ä»¶ã€‚é‡æ’­æœåŠ¡å™¨å°†æµé‡è½¬å‘ç»™ç»™å®šçš„åœ°å€ã€‚</p>
<h3 id="å®‰è£…">å®‰è£…</h3>
<p>æµ‹è¯•ç¯å¢ƒï¼š Windowsã€‚
ç‰ˆæœ¬ï¼š Version:1.3.0
å®‰è£…åˆ†2æ­¥éª¤ï¼š</p>
<ol>
<li>å‰ç½®æ¡ä»¶ï¼š å®‰è£…npcap 
<a href="https://npcap.com">https://npcap.com</a></li>
</ol>
<blockquote>
<p>GoReplayå¯ä»¥åœ¨Windowsæœºå™¨ä¸Šå·¥ä½œï¼Œä½†ç”±äºWindowså †æ ˆçš„ä¸åŒç½‘ç»œå±‚çš„æ€§è´¨ï¼Œå®ƒæœ‰ä¸€äº›ç»†èŠ‚ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼ŒWindowsä¸åƒUnixç³»ç»Ÿé‚£æ ·æœ‰æ”¯æŒåŒ…æ•è·çš„ç½‘ç»œé©±åŠ¨ç¨‹åºï¼Œå¦‚æœæ‚¨æƒ³æ•è·é€šä¿¡é‡ï¼Œåˆ™å¿…é¡»å•ç‹¬å®‰è£…å®ƒã€‚å…¶ä¸­ä¸€ä¸ªé€‰é¡¹æ˜¯å®‰è£…https://nmap.org/npcap/ã€‚</p>
</blockquote>
<ol start="2">
<li>å®‰è£…ï¼šè¿™é‡Œæµ‹è¯•ä½¿ç”¨çš„æ˜¯ gor-1.3.3_windows.zip
<a href="https://github.com/buger/goreplay/releases">https://github.com/buger/goreplay/releases</a> 
ä¸‹è½½è§£å‹å³å¯ã€‚</li>
</ol>
<h3 id="æ•è·æµé‡">æ•è·æµé‡</h3>
<blockquote>
<p>å¯åŠ¨ä¸¤ä¸ªhttpæœåŠ¡ï¼š</p>
</blockquote>
<ol>
<li>httpServerA: http://localhost:8000 ç›‘å¬ç«¯å£8000</li>
<li>httpServerB: http://localhost:8001 ç›‘å¬ç«¯å£8001</li>
</ol>
<p>è·¯ç”±ä¸º â€œget: &ldquo;/helloworld/{name}&rdquo;</p>
<blockquote>
<p>ç›‘å¬ç«¯å£8000ï¼Œå¹¶è¾“å‡ºåˆ°stdout</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"> ./gor --input-raw <span style="color:#960050;background-color:#1e0010">:</span>8000 --output-stdout
</code></pre></div><blockquote>
<p>æ‰“å¼€æµè§ˆå™¨è¯·æ±‚æ¥å£ http://localhost:8000/helloworld/lilei</p>
</blockquote>
<blockquote>
<p>åœ¨gorçš„å‘½ä»¤è¡Œçª—å£ï¼š</p>
</blockquote>
<pre tabindex="0"><code>1 db0a1f4000000001c344a1d3 1668261985986369000 0
GET /helloworld/lilei HTTP/1.1
Host: localhost:8000
Connection: keep-alive
sec-ch-ua: &quot; Not A;Brand&quot;;v=&quot; æ­¤å¤„çœç•¥ä¸€äº›ç³»æ•°
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: &quot;Windows&quot;
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°
</code></pre><p>å¯è§ï¼Œgorå·²ç»æŠŠæ•´ä¸ªhttpè¯·æ±‚çš„å®Œæ•´ä¿¡æ¯è®°å½•ä¸‹æ¥ã€‚
åŒæ—¶gorè¿˜æ”¯æŒè¾“å‡ºåˆ°æ–‡ä»¶å’ŒElasticSearchï¼Œè¿›è¡Œå›æ”¾å’Œåˆ†æã€‚è®°å½•åˆ°æ–‡ä»¶request.gor</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"> ./gor --input-raw <span style="color:#960050;background-color:#1e0010">:</span>8000 --output<span style="color:#f92672">-file</span> request.gor --input-raw-track-response --input-raw-override-snaplen
</code></pre></div><blockquote>
<p>æ‰“å¼€æµè§ˆå™¨è¯·æ±‚æ¥å£ http://localhost:8000/helloworld/hanmeimei</p>
</blockquote>
<p>å†™å…¥åˆ°æ–‡ä»¶ request_0.gor</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Mode                 LastWriteTime         Length Name
----                 -------------         ------ ---- 
-a----        2022/11/12     21<span style="color:#960050;background-color:#1e0010">:</span>36           1876 request_0.gor
</code></pre></div><p>request_0 å†…å®¹å¦‚ä¸‹:</p>
<pre tabindex="0"><code class="language-gor" data-lang="gor">1 d4571f4000000001b7adc1a6 1668260139796335000 0
GET /helloworld/lilei HTTP/1.1
Host: localhost:8000
Connection: keep-alive
sec-ch-ua: &quot; Not A;Brand&quot;;v=&quot;99&quot;, æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: &quot;Windows&quot;
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64), æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°


ğŸµğŸ™ˆğŸ™‰
2 d4571f4000000001b7adc1a6 1668260139796652000 0
HTTP/1.1 200 OK
Content-Type: application/json
Date: Sat, 12 Nov 2022 13:35:39 GMT
Content-Length: 25

{&quot;message&quot;:&quot;Hello lilei&quot;}
ğŸµğŸ™ˆğŸ™‰
1 d4571f4000000001b7adc22b 1668260148757949000 0
GET /helloworld/hanmeimei HTTP/1.1
Host: localhost:8000
Connection: keep-alive
sec-ch-ua: &quot; Not A;Brand&quot;;v=&quot;99&quot;, æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: &quot;Windows&quot;
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) , æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°


ğŸµğŸ™ˆğŸ™‰
2 d4571f4000000001b7adc22b 1668260148758268000 0
æ­¤å¤„çœç•¥ä¸€äº›å‚æ•°

{&quot;message&quot;:&quot;Hello hanmeimei&quot;}
ğŸµğŸ™ˆğŸ™‰

</code></pre><h3 id="æµé‡å›æ”¾">æµé‡å›æ”¾</h3>
<p>æ¥ç€å°†è¯¥æ–‡ä»¶request_0.gor è¿›è¡Œæµé‡å›æ”¾ï¼Œå¹¶è½¬å‘åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨ï¼ˆHttpServerBï¼‰ä¸Šï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">./gor --input<span style="color:#f92672">-file</span> request_0.gor --output-http http<span style="color:#960050;background-color:#1e0010">:</span>//localhost<span style="color:#960050;background-color:#1e0010">:</span>8001
</code></pre></div><p>è§‚å¯ŸHttpServerBæœåŠ¡å™¨æ§åˆ¶å°è¾“å‡ºï¼š</p>
<pre tabindex="0"><code>INFO ts=2022-11-12T21:37:26+08:00 caller=greeter.go:44 service.id=LAPTOP-H3HBMV8A service.name= service.version= trace.id= span.id= msg=CreateGreeter: lilei
INFO ts=2022-11-12T21:37:34+08:00 caller=greeter.go:44 service.id=LAPTOP-H3HBMV8A service.name= service.version= trace.id= span.id= msg=CreateGreeter: hanmeimei

</code></pre><p>ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªè¯·æ±‚ï¼ˆhttp://localhost:8000/helloworld/ileiã€http://localhost:8000/helloworld/hanmeimeiï¼‰åˆ†åˆ«é‡æ”¾è¯·æ±‚åˆ°äº†HttpServerBã€‚</p>
<p>goræ”¯æŒè¿›è¡Œæµé‡ç¼©å°ã€æ”¾å¤§ã€å€é€Ÿé‡æ”¾ï¼Œå®ç°çœŸå®æµé‡çš„å‹æµ‹æ•ˆæœã€‚
æ›´å¤šå‘½ä»¤ ./gor -help æŸ¥çœ‹</p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<ul>
<li>å®˜æ–¹GitHub  <a href="https://github.com/buger/goreplay">https://github.com/buger/goreplay</a></li>
<li>å®‰è£…åŒ… <a href="https://github.com/buger/goreplay/releases">https://github.com/buger/goreplay/releases</a></li>
<li>Windows å®‰è£… <a href="https://github.com/buger/goreplay/wiki/Running-on-Windows">https://github.com/buger/goreplay/wiki/Running-on-Windows</a></li>
<li>å®˜æ–¹npcap <a href="https://npcap.com/">https://npcap.com/</a></li>
<li>Goreplayè¯¦è§£ <a href="https://www.cnblogs.com/sunsky303/p/9072871.html">https://www.cnblogs.com/sunsky303/p/9072871.html</a></li>
<li>å…¥é—¨å’Œå¯¼å…¥Es  <a href="https://mp.weixin.qq.com/s/mNjLiEBnHIZhOTrDwNkmvA">https://mp.weixin.qq.com/s/mNjLiEBnHIZhOTrDwNkmvA</a></li>
<li>ç®€ä»‹  <a href="https://www.jianshu.com/p/0f3bcfbf7874">https://www.jianshu.com/p/0f3bcfbf7874</a></li>
</ul>
      
      <p>
        
          <a href="https://luckytking.github.io/2022/11/go%E7%BD%91%E7%BB%9C%E6%8A%93%E5%8C%85%E5%BC%95%E6%B5%81%E5%B7%A5%E5%85%B7goreplay/" class="postShorten-excerpt_link link" aria-label=""></a>
        
        
      </p>
    </div>
  </div>
  
</article>

            
              
  
    
      
        
      
    
  


  

<article class="postShorten postShorten--thumbnailimg-right">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://luckytking.github.io/2022/06/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0locust-boomer%E4%B9%8B%E4%BA%8C/" aria-label="">
      
          æ€§èƒ½æµ‹è¯•å¹³å°ï¼ˆlocust&#43;boomerï¼‰ä¹‹äºŒ
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-06-23T21:53:01&#43;08:00">
        
   23, 2022

      </time>
    
    
  
  
    <span></span>
    
      <a class="category-link" href="https://luckytking.github.io/categories/%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91">åç«¯å¼€å‘</a>
    
  

  </div>

    </div>
    <div class="postShorten-excerpt">
      
        <p>ä¸Šä¸€ç¯‡ï¼ˆ<a href="https://luckytking.github.io/2022/06/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0locust-boomer%E4%B9%8B%E4%B8%80/">ä¼ é€é—¨</a>ï¼‰ä»‹ç»äº†æµ‹è¯•å¹³å° locust + boomer çš„ç¯å¢ƒæ­å»ºï¼Œä»¥åŠè¿è¡Œhttpå‹æµ‹ç”¨ä¾‹ï¼Œè§‚æµ‹æ€§èƒ½æŒ‡æ•°ã€å›¾è¡¨ã€‚è¿™ç¯‡æ¥ä¸Šç¯‡ï¼Œç»§ç»­è®²go boomerå¦‚ä½•å®ç°ã€‚</p>
<h4 id="setup">setup</h4>
<h5 id="install-the-master-branch">Install the master branch</h5>
<blockquote>
<p>$ go get github.com/myzhan/boomer</p>
</blockquote>
<h5 id="install-a-tagged-version-that-works-with-locust-160">Install a tagged version that works with locust 1.6.0</h5>
<blockquote>
<p>$ go get <a href="mailto:github.com/myzhan/boomer@v1.6.0">github.com/myzhan/boomer@v1.6.0</a></p>
</blockquote>
<h5 id="install-gomq">install gomq</h5>
<blockquote>
<p>$ go get -u github.com/zeromq/gomq</p>
</blockquote>
<h4 id="quick-start">quick start</h4>
<h5 id="run-master">run master</h5>
<p>åˆ›å»ºpythonæ–‡ä»¶ workspace/dummy.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> locust <span style="color:#f92672">import</span> Locust, TaskSet, task
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTaskSet</span>(TaskSet):
    <span style="color:#a6e22e">@task</span>(<span style="color:#ae81ff">20</span>)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(self):
        <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dummy</span>(Locust):
    task_set <span style="color:#f92672">=</span> MyTaskSet
</code></pre></div><p>è¿è¡Œï¼š</p>
<blockquote>
<p>$ locust &ndash;master -f dummy.py
outputï¼š</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$locust.main: Starting web interface at http://0.0.0.0:8089 <span style="color:#f92672">(</span>accepting connections from all network interfaces<span style="color:#f92672">)</span>
$locust.main: Starting Locust 2.9.1.dev23
</code></pre></div><h5 id="run-slave">run slave</h5>
<p>åˆ›å»ºgoæ–‡ä»¶ workspace/main.go</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span>(
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;io/ioutil&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>
	<span style="color:#e6db74">&#34;github.com/myzhan/boomer&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">helloTask</span>() {
	<span style="color:#a6e22e">start</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">HttpGet</span>(<span style="color:#e6db74">&#34;hello&#34;</span>)
	<span style="color:#a6e22e">elapsed</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">start</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">RecordFailure</span>(<span style="color:#e6db74">&#34;http&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>, <span style="color:#a6e22e">elapsed</span>.<span style="color:#a6e22e">Nanoseconds</span>()<span style="color:#f92672">/</span>int64(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>), <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
		<span style="color:#66d9ef">return</span>
	}
    
<span style="color:#75715e">/*    Report your test result as a success, if you write it in locust, it will looks like this    events.request_success.fire(request_type=&#34;http&#34;, name=&#34;world&#34;, response_time=100, response_length=10)    */</span>
	<span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">RecordSuccess</span>(<span style="color:#e6db74">&#34;http&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>, <span style="color:#a6e22e">elapsed</span>.<span style="color:#a6e22e">Nanoseconds</span>()<span style="color:#f92672">/</span>int64(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>), int64(<span style="color:#ae81ff">10</span>))
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">worldTask</span>() {
	<span style="color:#a6e22e">start</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">HttpGet</span>(<span style="color:#e6db74">&#34;world&#34;</span>)
	<span style="color:#a6e22e">elapsed</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">start</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">RecordFailure</span>(<span style="color:#e6db74">&#34;udp&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>, <span style="color:#a6e22e">elapsed</span>.<span style="color:#a6e22e">Nanoseconds</span>()<span style="color:#f92672">/</span>int64(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>), <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
		<span style="color:#66d9ef">return</span>
	} 
<span style="color:#75715e">/*  Report your test result as a failure, if you write it in locust, it will looks like this    events.request_failure.fire(request_type=&#34;udp&#34;, name=&#34;hello&#34;, response_time=100, exception=Exception(&#34;udp error&#34;))    */</span>
	<span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">RecordSuccess</span>(<span style="color:#e6db74">&#34;udp&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>, <span style="color:#a6e22e">elapsed</span>.<span style="color:#a6e22e">Nanoseconds</span>()<span style="color:#f92672">/</span>int64(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>), int64(<span style="color:#ae81ff">10</span>))
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">task1</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">Task</span>{
		<span style="color:#75715e">// åŒæ—¶è·‘å¤šä¸ª tasks çš„æ—¶å€™ï¼ŒWeight å­—æ®µç”¨äºåˆ†é… goroutines
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">Weight</span>: <span style="color:#ae81ff">10</span>,
		<span style="color:#a6e22e">Fn</span>:     <span style="color:#a6e22e">helloTask</span>,
	}

	<span style="color:#a6e22e">task2</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">Task</span>{
		<span style="color:#a6e22e">Weight</span>: <span style="color:#ae81ff">10</span>,
		<span style="color:#a6e22e">Fn</span>:     <span style="color:#a6e22e">worldTask</span>,
	}

	<span style="color:#75715e">// è¿æ¥åˆ° masterï¼Œç­‰å¾…é¡µé¢ä¸Šä¸‹å‘æŒ‡ä»¤ï¼Œæ”¯æŒå¤šä¸ª Task
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">boomer</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">task1</span>, <span style="color:#a6e22e">task2</span>)
}


<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">HttpGet</span>(<span style="color:#a6e22e">path</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">error</span> {
	<span style="color:#a6e22e">url</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;http://localhost:8090/%s&#34;</span>, <span style="color:#a6e22e">path</span>)
	<span style="color:#a6e22e">method</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;GET&#34;</span>

	<span style="color:#a6e22e">client</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Client</span>{}
	<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">NewRequest</span>(<span style="color:#a6e22e">method</span>, <span style="color:#a6e22e">url</span>, <span style="color:#66d9ef">nil</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
	}
	<span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">req</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
	}
	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">Body</span>.<span style="color:#a6e22e">Close</span>()

	<span style="color:#a6e22e">body</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">Body</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
	}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(string(<span style="color:#a6e22e">body</span>))
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
}


</code></pre></div><blockquote>
<p>go run main.go</p>
</blockquote>
<p>output</p>
<pre tabindex="0"><code>$ Boomer is built with gomq support.
$ Boomer is connected to master(tcp://127.0.0.1:5557) press Ctrl+c to quit.

</code></pre><p>è¯´æ˜å¯åŠ¨slaveæˆåŠŸï¼ŒæŸ¥çœ‹æ˜¯å¦è¿æ¥ä¸Šmaster</p>
<pre tabindex="0"><code>$ locust.runners: Client 'crazyMac.local_axxbyy123456' reported as ready. Currently 1 clients ready to swarm.

</code></pre><p>è¯´æ˜å·²ç»è¿æ¥ä¸Šmaster
ã€‚</p>
<h4 id="testing">testing</h4>
<p>å¯åŠ¨æµ‹è¯•ï¼Œoutput
<img src="https://luckytking.github.io/images/locust-boomer.png" alt=""></p>
<p>succeed</p>
<h4 id="å°ç»“">å°ç»“</h4>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨go boomer å®ç°locustçš„é€šè®¯åè®®ï¼Œä»¥åŠä½¿ç”¨boomerå®ç°ä¸€ä¸ªä¸Šä¸€ç¯‡çš„httpå‹æµ‹ä¾‹å­ã€‚</p>
<h4 id="reference">reference</h4>
<ul>
<li>Locust Website:Â <a href="locust.io">locust.io</a></li>
<li>Locust Documentation:Â <a href="docs.locust.io">docs.locust.io</a></li>
<li>Boomer Documentation:Â <a href="boomer.readthedocs.io">boomer.readthedocs.io</a></li>
<li>Examples :<a href="https://github.com/myzhan/boomer/blob/master/_examples/default/main.go"> https://github.com/myzhan/boomer/blob/master/_examples/default/main.go</a></li>
<li>Dummy.py : <a href="https://www.cnblogs.com/Detector/p/11469233.html">https://www.cnblogs.com/Detector/p/11469233.html</a></li>
</ul>
      
      <p>
        
          <a href="https://luckytking.github.io/2022/06/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0locust-boomer%E4%B9%8B%E4%BA%8C/" class="postShorten-excerpt_link link" aria-label=""></a>
        
        
      </p>
    </div>
  </div>
  
</article>

            
              
  
    
      
        
      
    
  


  

<article class="postShorten postShorten--thumbnailimg-right">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://luckytking.github.io/2022/06/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0locust-boomer%E4%B9%8B%E4%B8%80/" aria-label="">
      
          æ€§èƒ½æµ‹è¯•å¹³å°ï¼ˆlocust&#43;boomerï¼‰ä¹‹ä¸€
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-06-19T16:11:18&#43;08:00">
        
   19, 2022

      </time>
    
    
  
  
    <span></span>
    
      <a class="category-link" href="https://luckytking.github.io/categories/%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91">åç«¯å¼€å‘</a>
    
  

  </div>

    </div>
    <div class="postShorten-excerpt">
      
        <p>æœ€è¿‘å…¬å¸æ‰“ç®—å¯¹åç«¯æœåŠ¡è¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œè€ƒè™‘åç«¯çš„ä¸»è¦ä½¿ç”¨golangå®ç°ï¼Œå› æ­¤ä½œè€…å‡†å¤‡ä½¿ç”¨ locust + boomer å®ç°ä¸€ä¸ªæ€§èƒ½æµ‹è¯•å¹³å°ï¼Œmarkä¸€ä¸‹å®ç°è¿‡ç¨‹ã€‚</p>
<h3 id="what-is-locust">what is locust</h3>
<blockquote>
<p>Locust æ˜¯ä¸€ç§æ˜“äºä½¿ç”¨ã€å¯ç¼–å†™è„šæœ¬ä¸”å¯æ‰©å±•çš„æ€§èƒ½æµ‹è¯•å·¥å…·ã€‚
æ‚¨å¯ä»¥åœ¨å¸¸è§„ Python ä»£ç ä¸­å®šä¹‰ç”¨æˆ·çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯åœç•™åœ¨ UI æˆ–é™åˆ¶æ€§ç‰¹å®šé¢†åŸŸçš„è¯­è¨€ä¸­ã€‚</p>
</blockquote>
<h3 id="what-is-boomer">what is boomer</h3>
<blockquote>
<p>boomer å®Œæ•´åœ°å®ç°äº† locust çš„é€šè®¯åè®®ï¼Œè¿è¡Œåœ¨ slave æ¨¡å¼ä¸‹ï¼Œç”¨ goroutine æ¥æ‰§è¡Œç”¨æˆ·æä¾›çš„æµ‹è¯•å‡½æ•°ï¼Œç„¶åå°†æµ‹è¯•ç»“æœä¸ŠæŠ¥ç»™è¿è¡Œåœ¨ master æ¨¡å¼ä¸‹çš„ locustã€‚</p>
<p><strong>ä¸ locust åŸç”Ÿçš„å®ç°ç›¸æ¯”ï¼Œè§£å†³äº†ä¸¤ä¸ªé—®é¢˜</strong>ã€‚
ä¸€æ˜¯å•å°æ–½å‹æœºä¸Šï¼Œèƒ½å……åˆ†åˆ©ç”¨å¤šä¸ª CPU æ ¸å¿ƒæ¥æ–½å‹ï¼Œ
äºŒæ˜¯å†ä¹Ÿä¸ç”¨æé˜²é˜»å¡ IO æ“ä½œå¯¼è‡´ gevent é˜»å¡ã€‚</p>
</blockquote>
<h3 id="ç¯å¢ƒ">ç¯å¢ƒ</h3>
<ul>
<li>æœåŠ¡å™¨
<ul>
<li>Ubuntu ï¼ˆ2æ ¸4G300Gï¼‰</li>
</ul>
</li>
<li>å‹æµ‹æœº
<ul>
<li>Mac</li>
<li>Python ç‰ˆæœ¬ Python 3.10.2</li>
<li>Go ç‰ˆæœ¬ go version go1.17.1 darwin/arm64</li>
</ul>
</li>
</ul>
<h3 id="å‹æµ‹æœº">å‹æµ‹æœº</h3>
<h4 id="å®‰è£…-locust">å®‰è£… locust</h4>
<ol>
<li>å®‰è£…python3.7æˆ–è€…ç‰ˆæœ¬å¤§äº3.7 ï¼ˆmac è‡ªå¸¦python2.Xç‰ˆæœ¬ï¼‰</li>
</ol>
<pre tabindex="0"><code>brew install python
</code></pre><p>æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬</p>
<pre tabindex="0"><code># python3 -V
Python 3.10.2
</code></pre><ol start="2">
<li>Install Locust</li>
</ol>
<pre tabindex="0"><code># pip3 install locust
</code></pre><ol start="3">
<li>æ£€æŸ¥å®‰è£…æ˜¯å¦æˆåŠŸ</li>
</ol>
<pre tabindex="0"><code># locust -V
locust 2.9.1.dev23
</code></pre><h4 id="è¿è¡Œ-locust-hello-world">è¿è¡Œ locust: hello-world</h4>
<p>è¦æŠŠå¤§è±¡æ”¾å†°ç®±ä¸€å…±åˆ†ä¸‰æ­¥ï¼šç¬¬ä¸€æ­¥æ‰“å¼€å†°ç®±&ndash;ï¼Œä¸ä¸ä¸ï¼Œç¬¬ä¸€æ­¥ï¼šå…ˆè¯•è¯•æŠŠå°è±¡(hello-world)çœ‹çœ‹èƒ½ä¸èƒ½æ”¾çš„è¿›å»</p>
<p>åœ¨å½“å‰ç›®å½• workspace/ åº•ä¸‹åˆ›å»º locustfile.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> locust <span style="color:#f92672">import</span> HttpUser, task
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HelloWorldUser</span>(HttpUser):
Â Â Â  <span style="color:#a6e22e">@task</span>
Â Â Â  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>(self):
Â Â Â Â Â Â Â  self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;/hello&#34;</span>)
Â Â Â Â Â Â Â  self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;/world&#34;</span>)
</code></pre></div><h5 id="å¯åŠ¨-locust"><strong>å¯åŠ¨ locust</strong></h5>
<pre tabindex="0"><code> # locust
 locust 
$: Starting web interface at http://0.0.0.0:8089 (accepting connections from all network interfaces)
$: Starting Locust 2.9.1.dev23

</code></pre><p>è®¿é—® http://localhost:8089/ å¯ä»¥çœ‹åˆ°
<img src="https://luckytking.github.io/images/locust-dashboard.png" alt=""></p>
<p>æ¥ç€ï¼Œè¿™è¾¹ä½¿ç”¨golangå¯åŠ¨ä¸€ä¸ªhttpæœåŠ¡ localhost:80ï¼ˆpathï¼š/hello &amp; /worldï¼‰</p>
<h5 id="locust---helloworld">locust - HelloWorld</h5>
<p>è¿›è¡Œä¸€ä¸ªç®€å•æµ‹è¯• 50 ä¸ªå¹¶å‘ç”¨æˆ·ï¼ŒåŠ é€Ÿé€Ÿåº¦ä¸º 1ä¸ªç”¨æˆ·/ç§’ï¼Œå°†å…¶æŒ‡å‘å“åº”/helloå’Œçš„æœåŠ¡å™¨/world
<img src="https://luckytking.github.io/images/locust-helloworld-test.png" alt=""></p>
<p>ç‚¹å‡» &ldquo;start swarming&rdquo;
<img src="https://luckytking.github.io/images/locust-helloworld.png" alt=""></p>
<p>åˆ‡æ¢æ ‡ç­¾é¡µ â€œChartsâ€
å¯ä»¥æŸ¥çœ‹ï¼šæ˜¾ç¤ºæ¯ç§’è¯·æ±‚æ•° (RPS)
<img src="https://luckytking.github.io/images/locust-dashboard-rps.png" alt=""></p>
<p>æŸ¥çœ‹ï¼šå“åº”æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ 
<img src="https://luckytking.github.io/images/locust-dashboard-responsetime.png" alt=""></p>
<p>æŸ¥çœ‹ï¼š ç”¨æˆ·æ•°é‡
<img src="https://luckytking.github.io/images/locust-dashboard-user.png" alt=""></p>
<h4 id="å°ç»“">å°ç»“</h4>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»æ€§èƒ½æµ‹è¯•å¹³å° locust + boomer çš„ç¯å¢ƒæ­å»ºï¼Œä»¥åŠè¿è¡Œhttp æµ‹è¯•ç”¨ä¾‹helloworldï¼Œä½¿ç”¨locustè§‚æµ‹æ€§èƒ½æŒ‡æ•°ã€å›¾è¡¨ç­‰ã€‚</p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<ul>
<li><a href="https://locust.io/">https://locust.io/</a></li>
<li><a href="https://github.com/myzhan/boomer">https://github.com/myzhan/boomer</a></li>
</ul>
      
      <p>
        
          <a href="https://luckytking.github.io/2022/06/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0locust-boomer%E4%B9%8B%E4%B8%80/" class="postShorten-excerpt_link link" aria-label=""></a>
        
        
      </p>
    </div>
  </div>
  
</article>

            
              
  
    
      
        
      
    
  


  

<article class="postShorten postShorten--thumbnailimg-right">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
      
        <a class="link-unstyled" href="https://luckytking.github.io/2022/05/googlemeta%E7%AC%AC%E4%B8%89%E6%96%B9%E7%99%BB%E5%85%A5%E5%90%8E%E7%AB%AF%E9%AA%8C%E8%AF%81/" aria-label="">
      
          Googleã€metaç¬¬ä¸‰æ–¹ç™»å…¥åç«¯éªŒè¯
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-05-29T16:01:18&#43;08:00">
        
   29, 2022

      </time>
    
    
  
  
    <span></span>
    
      <a class="category-link" href="https://luckytking.github.io/categories/%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91">åç«¯å¼€å‘</a>
    
  

  </div>

    </div>
    <div class="postShorten-excerpt">
      
        <p>æœ¬æ–‡ä¸»è¦è®°å½• Android app ç¬¬ä¸‰æ–¹ï¼ˆgoogleå’Œmeta/facebook)ç™»å…¥çš„åç«¯(go)éªŒè¯ã€‚</p>
<h2 id="android-sdk-æ¥å…¥æµç¨‹">android sdk æ¥å…¥æµç¨‹</h2>
<p>å¯å‚è€ƒ
<a href="https://juejin.cn/post/7094889100389384228">https://juejin.cn/post/7094889100389384228</a></p>
<h2 id="google">google</h2>
<p>å®˜ç½‘é“¾æ¥: (<a href="https://developers.google.com/identity/sign-in/web/backend-auth">https://developers.google.com/identity/sign-in/web/backend-auth</a>)
å®˜ç½‘æ¨èä¸¤ä¸­éªŒè¯æ–¹å¼ ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨è°·æ­ŒAPIå®¢æˆ·ç«¯åº“</strong>ï¼ŒåŒ…æ‹¬Javaã€Node.jsã€PHPã€Pythonï¼Œæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éªŒè¯è°·æ­ŒIDä»¤ç‰Œçš„æ¨èæ–¹æ³•ã€‚<strong>goå®¢æˆ·ç«¯åº“</strong>ï¼šhttps://github.com/googleapis/google-api-go-client)</li>
<li><strong>è°ƒç”¨è°·æ­ŒAPI</strong>ï¼ˆhttps://oauth2.googleapis.com/tokeninfo?id_token=XYZ123ï¼‰</li>
</ol>
<p>è¿™é‡Œé‡‡ç”¨ç¬¬ä¸€ç§ï¼Œå‚è€ƒä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;context&#34;</span>
	<span style="color:#e6db74">&#34;fmt&#34;</span> 
	<span style="color:#e6db74">&#34;google.golang.org/api/oauth2/v2&#34;</span>
	<span style="color:#e6db74">&#34;google.golang.org/api/option&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
   <span style="color:#75715e">// ä»å®¢æˆ·ç«¯è·å–çš„è°·æ­Œtoken
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">googleToken</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">`user token from client`</span>
	<span style="color:#a6e22e">oatuService</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">oauth2</span>.<span style="color:#a6e22e">NewService</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#a6e22e">option</span>.<span style="color:#a6e22e">WithHTTPClient</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">DefaultClient</span>))
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> { 
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">tokenInfoCall</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">oatuService</span>.<span style="color:#a6e22e">Tokeninfo</span>()
	<span style="color:#a6e22e">tokenInfoCall</span>.<span style="color:#a6e22e">IdToken</span>(<span style="color:#a6e22e">googleToken</span>)
	<span style="color:#a6e22e">tokenInfo</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tokenInfoCall</span>.<span style="color:#a6e22e">Do</span>() 
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> { 
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">tokenInfo</span>)
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%v&#34;</span>, <span style="color:#a6e22e">tokenInfo</span>)
    <span style="color:#75715e">//å¯ä»¥æ‹¿å®¢æˆ·ç«¯å‘é€çš„idï¼Œå’Œ tokenInfo.Id åšæ ¡éªŒ
</span><span style="color:#75715e"></span>}
</code></pre></div><h2 id="metafacebook-ç™»å…¥">meta(facebook) ç™»å…¥</h2>
<p>meta çš„éªŒè¯å’Œ google ç±»å‹ï¼Œè°ƒç”¨éªŒè¯api</p>
<p>å®˜ç½‘é“¾æ¥:</p>
<ol>
<li><strong>Androidç‰ˆæœ¬Facebookå¿«é€Ÿå…¥é—¨</strong>ï¼šhttps://developers.facebook.com/docs/facebook-login/android</li>
<li><strong>åç«¯éªŒè¯</strong> : (<a href="https://developers.facebook.com/docs/facebook-login/guides/%20access-tokens/get-session-info">https://developers.facebook.com/docs/facebook-login/guides/%20access-tokens/get-session-info</a>)</li>
</ol>
<p>è¯·æ±‚æ ¼å¼ï¼š</p>
<pre tabindex="0"><code>GET /debug_token?
  input_token={session-info-token}&amp;
  access_token={your-access-token}
</code></pre><p><strong>go-api</strong> : <a href="https://developers.facebook.com/docs/facebook-login/guides/%20access-tokens/get-session-info">https://developers.facebook.com/docs/facebook-login/guides/%20access-tokens/get-session-info</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#a6e22e">fb</span> <span style="color:#e6db74">&#34;github.com/huandu/facebook/v2&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
   <span style="color:#75715e">//å®¢æˆ·ç«¯ä¼ é€’è¿‡æ¥çš„ token
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">inputToken</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;token from client&#34;</span>
	<span style="color:#a6e22e">globalApp</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fb</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;developer-app-client-id&#34;</span>, <span style="color:#e6db74">&#34;develop-app-client-secret&#34;</span>)
    <span style="color:#75715e">//ç”Ÿæˆ access_token
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">token</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">globalApp</span>.<span style="color:#a6e22e">AppAccessToken</span>()
	<span style="color:#a6e22e">session</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">globalApp</span>.<span style="color:#a6e22e">Session</span>(<span style="color:#a6e22e">token</span>)
	<span style="color:#a6e22e">resp</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">session</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;debug_token&#34;</span>, <span style="color:#a6e22e">fb</span>.<span style="color:#a6e22e">Params</span>{
		<span style="color:#e6db74">&#34;input_token&#34;</span>: <span style="color:#a6e22e">inputToken</span>,
	})
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span>
	}
}
</code></pre></div><h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="https://developers.google.com/identity/sign-in/web/backend-auth">https://developers.google.com/identity/sign-in/web/backend-auth</a></li>
<li><a href="https://github.com/googleapis/google-api-go-client">https://github.com/googleapis/google-api-go-client</a></li>
<li><a href="https://juejin.cn/post/7094889100389384228">https://juejin.cn/post/7094889100389384228</a></li>
<li><a href="https://developers.facebook.com/docs/facebook-login/guides/%20access-tokens/get-session-info">https://developers.facebook.com/docs/facebook-login/guides/%20access-tokens/get-session-info</a></li>
<li><a href="https://github.com/huandu/facebook/v2">https://github.com/huandu/facebook/v2</a></li>
</ul>
      
      <p>
        
          <a href="https://luckytking.github.io/2022/05/googlemeta%E7%AC%AC%E4%B8%89%E6%96%B9%E7%99%BB%E5%85%A5%E5%90%8E%E7%AB%AF%E9%AA%8C%E8%AF%81/" class="postShorten-excerpt_link link" aria-label=""></a>
        
        
      </p>
    </div>
  </div>
  
</article>

            
            

          </section>
        
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 jefffff. 
  </span>
</footer>

      </div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://luckytking.github.io/images/tk.jpg" alt="" />
    
    <h4 id="about-card-name">jefffff</h4>
    
      <div id="about-card-bio">Stay hungry. Stay Foolish  <strong>COOL</strong></div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Go backend developer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        China Amoy
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://luckytking.github.io/images/cover-v1.2.0.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://luckytking.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

